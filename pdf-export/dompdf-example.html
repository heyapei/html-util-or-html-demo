<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dompdf.js ä½¿ç”¨ç¤ºä¾‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Han Sans SC', 'Source Han Sans CN', 'Noto Sans CJK SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .control-panel {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .control-panel h2 {
            color: #333;
            margin-bottom: 15px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        #loading {
            display: none;
            margin-left: 10px;
            color: #667eea;
            font-weight: bold;
        }

        /* PDFå†…å®¹åŒºåŸŸæ ·å¼ */
        #pdf-content {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .pdf-header {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
            margin-bottom: 30px;
        }

        .pdf-header h1 {
            color: #667eea;
            font-size: 36px;
            margin-bottom: 10px;
        }

        .pdf-header p {
            color: #666;
            font-size: 14px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            color: #333;
            font-size: 24px;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 4px solid #667eea;
        }

        .info-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 2px solid #e9ecef;
        }

        .info-row {
            display: flex;
            padding: 10px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: bold;
            color: #495057;
            width: 120px;
        }

        .info-value {
            color: #212529;
            flex: 1;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .feature-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #667eea;
            text-align: center;
        }

        .feature-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .feature-text {
            color: #333;
            font-size: 14px;
        }

        /* å¤æ‚æ ·å¼æ¼”ç¤º - ä½¿ç”¨foreignObjectRendering */
        .complex-box {
            width: 100%;
            height: 150px;
            margin: 15px 0;
        }

        .gradient-shadow-box {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: bold;
        }

        .table-container {
            margin-top: 15px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid #667eea;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #dee2e6;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .image-demo {
            text-align: center;
            margin-top: 15px;
        }

        .image-demo img {
            max-width: 200px;
            border-radius: 8px;
            border: 3px solid #667eea;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
            color: #6c757d;
            font-size: 14px;
        }

        @media print {
            body {
                background: white;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="control-panel">
            <h2>ğŸ¯ dompdf.js æ¼”ç¤ºæ§åˆ¶å°</h2>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="generatePDF()">
                    ğŸ“„ ç”ŸæˆPDFï¼ˆæ— ä¸­æ–‡å­—ä½“ï¼‰
                </button>
                <button class="btn btn-primary" onclick="generatePDFWithFont()">
                    ğŸ“„ ç”ŸæˆPDFï¼ˆå«ä¸­æ–‡å­—ä½“ï¼‰
                </button>
                <button class="btn btn-secondary" onclick="resetContent()">
                    ğŸ”„ é‡ç½®å†…å®¹
                </button>
            </div>
            <span id="loading">â³ æ­£åœ¨ç”ŸæˆPDFï¼Œè¯·ç¨å€™...</span>
            <div style="margin-top: 15px; padding: 10px; background: #d1ecf1; border-radius: 6px; border: 1px solid #0c5460;">
                <strong>ğŸ’¡ æç¤ºï¼š</strong>
                <ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8;">
                    <li>"æ— ä¸­æ–‡å­—ä½“"ç‰ˆæœ¬ï¼šè‹±æ–‡æ­£å¸¸ï¼Œä¸­æ–‡ä¼šæ˜¾ç¤ºä¸ºæ–¹å—ï¼ˆæ¼”ç¤ºä¹±ç é—®é¢˜ï¼‰</li>
                    <li>"å«ä¸­æ–‡å­—ä½“"ç‰ˆæœ¬ï¼šâœ… å·²åŠ è½½æ€æºé»‘ä½“ï¼ˆSource Han Sans SCï¼‰ï¼Œä¸­æ–‡å®Œç¾æ˜¾ç¤ºï¼</li>
                    <li>å¸¦æœ‰<code>foreignObjectRendering</code>å±æ€§çš„å…ƒç´ ä¼šä»¥å›¾ç‰‡æ–¹å¼æ¸²æŸ“ï¼ˆå¦‚æ¸å˜é˜´å½±æ¡†ï¼‰</li>
                    <li>æ€æºé»‘ä½“æ˜¯æ¨èçš„ä¸­æ–‡å­—ä½“ï¼Œä½“ç§¯å°ã€æ˜¾ç¤ºæ•ˆæœå¥½</li>
                </ul>
            </div>
        </div>

        <!-- PDFå†…å®¹åŒºåŸŸ -->
        <div id="pdf-content">
            <!-- é¡µçœ‰ -->
            <div class="pdf-header">
                <h1>ğŸ“‹ dompdf.js åŠŸèƒ½æ¼”ç¤ºæ–‡æ¡£</h1>
                <p>Demo Document - Generated by dompdf.js</p>
                <p style="margin-top: 5px;">ç”Ÿæˆæ—¶é—´ï¼š<span id="generate-time"></span></p>
            </div>

            <!-- åŸºæœ¬ä¿¡æ¯ -->
            <div class="section">
                <h2 class="section-title">ğŸ“Œ åŸºæœ¬ä¿¡æ¯</h2>
                <div class="info-card">
                    <div class="info-row">
                        <span class="info-label">é¡¹ç›®åç§°ï¼š</span>
                        <span class="info-value">dompdf.js ä½¿ç”¨ç¤ºä¾‹</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">ç‰ˆæœ¬å·ï¼š</span>
                        <span class="info-value">v1.0.4</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">å¼€æºåè®®ï¼š</span>
                        <span class="info-value">MIT License</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">GitHubï¼š</span>
                        <span class="info-value">https://github.com/lmn1919/dompdf.js</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">æè¿°ï¼š</span>
                        <span class="info-value">å°†HTMLè½¬æ¢ä¸ºå¯ç¼–è¾‘ã€éå›¾ç‰‡å¼ã€é«˜æ¸…æ™°åº¦ã€å°ä½“ç§¯ã€å¯æ‰“å°çš„PDF</span>
                    </div>
                </div>
            </div>

            <!-- æ ¸å¿ƒç‰¹æ€§ -->
            <div class="section">
                <h2 class="section-title">âœ¨ æ ¸å¿ƒç‰¹æ€§</h2>
                <div class="feature-grid">
                    <div class="feature-item">
                        <div class="feature-icon">ğŸŒ</div>
                        <div class="feature-text">çº¯å®¢æˆ·ç«¯æ¸²æŸ“<br>æ— éœ€æœåŠ¡å™¨æ”¯æŒ</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ğŸ“</div>
                        <div class="feature-text">çœŸæ­£çš„PDF<br>å¯ç¼–è¾‘å¯é€‰ä¸­</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ğŸ’¾</div>
                        <div class="feature-text">æ–‡ä»¶ä½“ç§¯å°<br>åŠ è½½é€Ÿåº¦å¿«</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ğŸ¨</div>
                        <div class="feature-text">æ ·å¼ä¸°å¯Œ<br>æ”¯æŒå¤šç§CSS</div>
                    </div>
                </div>
            </div>

            <!-- å¤æ‚æ ·å¼æ¼”ç¤º -->
            <div class="section">
                <h2 class="section-title">ğŸ¨ å¤æ‚æ ·å¼æ¼”ç¤ºï¼ˆforeignObjectRenderingï¼‰</h2>
                <p style="color: #666; margin-bottom: 10px;">ä»¥ä¸‹å…ƒç´ ä½¿ç”¨foreignObjectRenderingå±æ€§ï¼Œä¼šä»¥å›¾ç‰‡æ–¹å¼æ¸²æŸ“ä»¥ä¿è¯æ•ˆæœï¼š</p>
                <div class="complex-box" foreignObjectRendering>
                    <div class="gradient-shadow-box">
                        æ¸å˜èƒŒæ™¯ + é˜´å½±æ•ˆæœ
                    </div>
                </div>
            </div>

            <!-- æ•°æ®è¡¨æ ¼ -->
            <div class="section">
                <h2 class="section-title">ğŸ“Š æ•°æ®è¡¨æ ¼ç¤ºä¾‹</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>åºå·</th>
                                <th>åŠŸèƒ½æ¨¡å—</th>
                                <th>æ”¯æŒçŠ¶æ€</th>
                                <th>å¤‡æ³¨è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>æ–‡æœ¬æ¸²æŸ“</td>
                                <td>âœ… å·²æ”¯æŒ</td>
                                <td>æ”¯æŒå­—ä½“ã€é¢œè‰²ã€å¤§å°ç­‰</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>å›¾ç‰‡æ¸²æŸ“</td>
                                <td>âœ… å·²æ”¯æŒ</td>
                                <td>ç½‘ç»œå›¾ç‰‡ã€base64ã€SVG</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>è¾¹æ¡†æ ·å¼</td>
                                <td>âœ… å·²æ”¯æŒ</td>
                                <td>ç›®å‰ä»…æ”¯æŒå®çº¿è¾¹æ¡†</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>èƒŒæ™¯æ•ˆæœ</td>
                                <td>âœ… å·²æ”¯æŒ</td>
                                <td>é¢œè‰²ã€å›¾ç‰‡ã€æ¸å˜</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>Canvas/SVG</td>
                                <td>âœ… å·²æ”¯æŒ</td>
                                <td>å®Œæ•´æ”¯æŒ</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>iframe</td>
                                <td>âŒ æœªæ”¯æŒ</td>
                                <td>æš‚ä¸æ”¯æŒ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- å›¾ç‰‡ç¤ºä¾‹ -->
            <div class="section">
                <h2 class="section-title">ğŸ–¼ï¸ å›¾ç‰‡æ¸²æŸ“ç¤ºä¾‹</h2>
                <div class="image-demo">
                    <p style="color: #666; margin-bottom: 10px;">Base64 å›¾ç‰‡ç¤ºä¾‹ï¼ˆä¸€ä¸ªç®€å•çš„ç¬‘è„¸SVGï¼‰ï¼š</p>
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjgwIiBmaWxsPSIjRkZEQzAwIi8+PGNpcmNsZSBjeD0iNzAiIGN5PSI4MCIgcj0iMTAiIGZpbGw9IiMzMzMiLz48Y2lyY2xlIGN4PSIxMzAiIGN5PSI4MCIgcj0iMTAiIGZpbGw9IiMzMzMiLz48cGF0aCBkPSJNIDYwIDEyMCBRIDEwMCAxNjAgMTQwIDEyMCIgc3Ryb2tlPSIjMzMzIiBzdHJva2Utd2lkdGg9IjUiIGZpbGw9Im5vbmUiLz48L3N2Zz4=" alt="ç¬‘è„¸å›¾æ ‡">
                </div>
            </div>

            <!-- æ–‡æœ¬æ ·å¼ -->
            <div class="section">
                <h2 class="section-title">ğŸ“ æ–‡æœ¬æ ·å¼ç¤ºä¾‹</h2>
                <div class="info-card">
                    <p style="font-size: 12px; color: #666;">å°å·æ–‡æœ¬ (12px)</p>
                    <p style="font-size: 16px; color: #333;">æ™®é€šæ–‡æœ¬ (16px)</p>
                    <p style="font-size: 20px; color: #667eea; font-weight: bold;">åŠ ç²—å½©è‰²æ–‡æœ¬ (20px)</p>
                    <p style="font-size: 14px; font-style: italic; color: #6c757d;">æ–œä½“æ–‡æœ¬ (14px italic)</p>
                    <p style="font-size: 16px; text-decoration: underline; color: #dc3545;">ä¸‹åˆ’çº¿æ–‡æœ¬</p>
                    <p style="font-size: 16px; text-decoration: line-through; color: #6c757d;">åˆ é™¤çº¿æ–‡æœ¬</p>
                </div>
            </div>

            <!-- é¡µè„š -->
            <div class="footer">
                <p>æœ¬æ–‡æ¡£ç”± dompdf.js è‡ªåŠ¨ç”Ÿæˆ</p>
                <p>GitHub: https://github.com/lmn1919/dompdf.js</p>
                <p style="margin-top: 10px;">Â© 2025 dompdf.js - MIT License</p>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥dompdf.jsåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/dompdf.js@1.0.4/dist/dompdf.min.js"></script>
    
    <!-- å¼•å…¥ä¸­æ–‡å­—ä½“ -->
    <script src="./res/SourceHanSansSC-Normal-Min-normal.js"></script>

    <script>
        // æ›´æ–°ç”Ÿæˆæ—¶é—´
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('generate-time').textContent = timeString;
        }

        // é¡µé¢åŠ è½½æ—¶æ›´æ–°æ—¶é—´
        updateTime();

        // ç”ŸæˆPDFï¼ˆæ— ä¸­æ–‡å­—ä½“ï¼‰
        function generatePDF() {
            const loading = document.getElementById('loading');
            loading.style.display = 'inline';
            
            // æ›´æ–°æ—¶é—´
            updateTime();

            // å»¶è¿Ÿä¸€ä¸‹è®©æ—¶é—´æ˜¾ç¤ºæ›´æ–°
            setTimeout(() => {
                dompdf(document.querySelector("#pdf-content"), {
                    useCORS: true // å…è®¸è·¨åŸŸ
                })
                .then(function (blob) {
                    loading.style.display = 'none';
                    
                    // ä¸‹è½½PDF
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'dompdf-demo-' + Date.now() + '.pdf';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    alert('âœ… PDFç”ŸæˆæˆåŠŸï¼\n\næ³¨æ„ï¼šç”±äºæœªåŠ è½½ä¸­æ–‡å­—ä½“ï¼Œä¸­æ–‡å¯èƒ½æ˜¾ç¤ºä¸ºæ–¹å—ã€‚');
                })
                .catch(function (err) {
                    loading.style.display = 'none';
                    console.error('PDFç”Ÿæˆå¤±è´¥ï¼š', err);
                    alert('âŒ PDFç”Ÿæˆå¤±è´¥ï¼š' + err.message);
                });
            }, 100);
        }

        // ç”ŸæˆPDFï¼ˆå«ä¸­æ–‡å­—ä½“ï¼‰
        function generatePDFWithFont() {
            // æ£€æŸ¥å­—ä½“æ˜¯å¦å·²åŠ è½½
            if (!window.fontBase64) {
                alert('âŒ é”™è¯¯ï¼šä¸­æ–‡å­—ä½“æ–‡ä»¶æœªæ­£ç¡®åŠ è½½ï¼\n\nè¯·ç¡®ä¿ res/SourceHanSansSC-Normal-Min-normal.js æ–‡ä»¶å­˜åœ¨ã€‚');
                return;
            }
            
            const loading = document.getElementById('loading');
            loading.style.display = 'inline';
            
            // æ›´æ–°æ—¶é—´
            updateTime();
            
            // å»¶è¿Ÿä¸€ä¸‹è®©æ—¶é—´æ˜¾ç¤ºæ›´æ–°
            setTimeout(() => {
                dompdf(document.querySelector("#pdf-content"), {
                    useCORS: true,
                    font: window.fontBase64
                })
                .then(function (blob) {
                    loading.style.display = 'none';
                    
                    // ä¸‹è½½PDF
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'dompdf-demo-chinese-' + Date.now() + '.pdf';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    alert('âœ… å¸¦ä¸­æ–‡å­—ä½“çš„PDFç”ŸæˆæˆåŠŸï¼\n\nä¸­æ–‡å­—ç¬¦åº”è¯¥å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†ï¼');
                })
                .catch(function (err) {
                    loading.style.display = 'none';
                    console.error('PDFç”Ÿæˆå¤±è´¥ï¼š', err);
                    alert('âŒ PDFç”Ÿæˆå¤±è´¥ï¼š' + err.message);
                });
            }, 100);
        }

        // é‡ç½®å†…å®¹
        function resetContent() {
            updateTime();
            alert('âœ… å†…å®¹å·²é‡ç½®ï¼Œæ—¶é—´å·²æ›´æ–°ï¼');
        }

        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + P ç”ŸæˆPDF
            if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                e.preventDefault();
                generatePDF();
            }
        });

        console.log('%cğŸ‰ dompdf.js æ¼”ç¤ºé¡µé¢', 'font-size: 20px; color: #667eea; font-weight: bold;');
        console.log('%cğŸ“š ä½¿ç”¨è¯´æ˜ï¼š', 'font-size: 14px; color: #333; font-weight: bold;');
        console.log('1. ç‚¹å‡»"ç”ŸæˆPDF"æŒ‰é’®ä¸‹è½½PDFæ–‡ä»¶');
        console.log('2. æˆ–ä½¿ç”¨å¿«æ·é”® Ctrl/Cmd + P');
        console.log('3. å¸¦æœ‰foreignObjectRenderingå±æ€§çš„å…ƒç´ ä¼šä»¥å›¾ç‰‡æ–¹å¼æ¸²æŸ“');
        console.log('4. âœ… ä¸­æ–‡å­—ä½“å·²åŠ è½½ï¼š' + (window.fontBase64 ? 'æˆåŠŸ' : 'å¤±è´¥'));
    </script>
</body>
</html>

