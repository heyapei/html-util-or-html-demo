# 图片批量填充工具

读取 Excel 数据，自动将文字填充到图片模板的指定位置，批量生成图片。

## 功能特性

### 📥 数据导入
- 支持上传模板图片（JPG、PNG、WebP）
- 支持上传 Excel 文件（.xlsx、.xls）
- 自动解析 Excel 表头作为可选字段
- 数据预览（显示前5条）

### ⚙️ 字段配置
- 可添加多个文字字段
- 每个字段可配置：
  - 绑定的 Excel 列
  - 默认值（Excel 数据为空时使用）
  - 位置坐标（X, Y）
  - 字体大小
  - 文字颜色
  - 背景色（支持透明）
  - 字体（微软雅黑、黑体、宋体、楷体等）
- 可视化拖拽定位 - 在预览图上直接拖动标记调整位置
- 标记样式实时反映字段配置

### 📝 文件命名
- 自定义前缀和后缀
- 支持多列组合命名
- 自定义列分隔符
- 可选随机数后缀防止重名

### 🖼️ 输出设置
- 输出格式：JPEG / PNG / WebP
- 自动检测原图格式并设为默认
- 图片质量调节（10% - 100%）
- 预估文件大小显示

### 📦 批量生成
- 实时进度显示
- 预估剩余时间
- 图片边生成边显示
- 点击图片可放大预览
- 键盘左右键切换预览
- 单张下载或打包下载（ZIP）
- ZIP 文件名包含时间戳和图片数量

## 使用步骤

1. **上传模板图片** - 选择需要填充文字的背景图
2. **上传 Excel 文件** - 包含要填充的数据，第一行为表头
3. **配置字段** - 选择要填充的列，设置位置和样式
4. **设置命名规则** - 配置生成图片的文件名格式
5. **选择输出格式** - 选择图片格式和质量
6. **开始生成** - 点击按钮批量生成图片

## 技术栈

- 原生 JavaScript（无框架依赖）
- [SheetJS (xlsx)](https://sheetjs.com/) - Excel 文件解析
- [JSZip](https://stuk.github.io/jszip/) - ZIP 压缩
- [FileSaver.js](https://github.com/eligrey/FileSaver.js/) - 文件下载
- Canvas API - 图片绘制

## 文件结构

```
image-fill/
├── index.html   # 页面结构
├── app.js       # 业务逻辑
├── style.css    # 样式
└── README.md    # 说明文档
```

## 注意事项

- 中文字体需要系统已安装对应字体
- 大量图片生成时建议使用 JPEG 格式减小文件体积
- PNG 格式支持透明背景但文件较大
- WebP 格式压缩效率最高但兼容性稍差
